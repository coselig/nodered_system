# SunWave協定筆記

## High/Low 轉換解釋

### 擷取前半段

const hi = (addr >> 8) & 0xFF;

### 擷取後半段

const lo = addr & 0xFF;

## R410

### 寫入單個繼電器

|  relay |    1   |    2   |    3   |    4   |
|--------|--------|--------|--------|--------|
| address| 0x0000 | 0x0001 | 0x0002 | 0x0003 |

> 功能碼

控制單一 relay  :  0x05

> 控制項

Relay 釋放 : 0x0000

Relay 吸住 : 0x00FF

> 示範

|id|功能碼|relay id high|relay id low|value high|value low|說明|
|--|------|------|------|------|------|-----------|
|id| 0x05 | 0x00 | 0x00 | 0x00 | 0xFF |relay1-吸住|
|id| 0x05 | 0x00 | 0x00 | 0x00 | 0x00 |relay1-放開|
|id| 0x05 | 0x00 | 0x01 | 0x00 | 0xFF |relay1-吸住|
|id| 0x05 | 0x00 | 0x01 | 0x00 | 0x00 |relay2-放開|

### 寫入多個繼電器(0x0f)

|  relay |    1   |    2   |    3   |    4   |
|--------|--------|--------|--------|--------|
| address| 0x0000 | 0x0001 | 0x0002 | 0x0003 |

> 控制項

後面可以自己設定byte數量

數量後面後面接byte資料'0000 0101'

0 是

> 示範

|id|function code|   #  |  #   | port |count | data count(byte) | byte value |  description   |
|--|-------------|------|------|------|------|------------------|------------|----------------|
|id|     0x0F    | 0x00 | 0x00 | 0x00 | 0x04 |       0x01       |     0x01   |寫入R410:0,0,0,1|
|id|     0x0F    | 0x00 | 0x00 | 0x00 | 0x04 |       0x01       |     0x02   |寫入R410:0,0,1,0|
|id|     0x0F    | 0x00 | 0x00 | 0x00 | 0x04 |       0x01       |     0x03   |寫入R410:0,0,1,1|
|id|     0x0F    | 0x00 | 0x00 | 0x00 | 0x04 |       0x01       |     0x04   |寫入R410:0,1,0,0|
|id|     0x0F    | 0x00 | 0x00 | 0x00 | 0x04 |       0x01       |     0x08   |寫入R410:1,0,0,0|
|id|     0x0F    | 0x00 | 0x00 | 0x00 | 0x04 |       0x01       |     0x0c   |寫入R410:1,1,0,0|

### 寫入多個繼電器(遞歸, 0x06)

> 示範

|id|function code|function|code| time | output |  description   |
|--|-------------|------|------|------|--------|----------------|
|id|     0x06    | 0x01 | 0x9b | 0x14 |  0x04  |輸出0000 0100 14*0.1秒復歸|
